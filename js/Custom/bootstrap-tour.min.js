(function(n,t){return typeof define=="function"&&define.amd?define(["jquery"],function(i){return n.Tour=t(i)}):typeof exports=="object"?module.exports=t(require("jQuery")):n.Tour=t(n.jQuery)})(window,function(n){var t;return t=window.document,function(){function i(t){var i;try{i=window.localStorage}catch(r){i=!1}this._options=n.extend({name:"tour",steps:[],container:"body",autoscroll:!0,keyboard:!0,storage:i,debug:!1,backdrop:!1,backdropContainer:"body",backdropPadding:0,redirect:!0,orphan:!1,duration:!1,delay:!1,basePath:"",template:'<div class="popover" role="tooltip"> <div class="arrow"><\/div> <h3 class="popover-title"><\/h3> <div class="popover-content"><\/div> <div class="popover-navigation"> <div class="btn-group"> <button class="btn btn-sm btn-default" data-role="prev">&laquo; Prev<\/button> <button class="btn btn-sm btn-default" data-role="next">Next &raquo;<\/button> <button class="btn btn-sm btn-default" data-role="pause-resume" data-pause-text="Pause" data-resume-text="Resume">Pause<\/button> <\/div> <button class="btn btn-sm btn-default" data-role="end">End tour<\/button> <\/div> <\/div>',afterSetState:function(){},afterGetState:function(){},afterRemoveState:function(){},onStart:function(){},onEnd:function(){},onShow:function(){},onShown:function(){},onHide:function(){},onHidden:function(){},onNext:function(){},onPrev:function(){},onPause:function(){},onResume:function(){},onRedirectError:function(){}},t);this._force=!1;this._inited=!1;this._current=null;this.backdrop={overlay:null,$element:null,$background:null,backgroundShown:!1,overlayElementShown:!1};this}return i.prototype.addSteps=function(n){for(var i,t=0,r=n.length;t<r;t++)i=n[t],this.addStep(i);return this},i.prototype.addStep=function(n){return this._options.steps.push(n),this},i.prototype.getStep=function(t){if(this._options.steps[t]!=null)return n.extend({id:"step-"+t,path:"",host:"",placement:"right",title:"",content:"<p><\/p>",next:t===this._options.steps.length-1?-1:t+1,prev:t-1,animation:!0,container:this._options.container,autoscroll:this._options.autoscroll,backdrop:this._options.backdrop,backdropContainer:this._options.backdropContainer,backdropPadding:this._options.backdropPadding,redirect:this._options.redirect,reflexElement:this._options.steps[t].element,backdropElement:this._options.steps[t].element,orphan:this._options.orphan,duration:this._options.duration,delay:this._options.delay,template:this._options.template,onShow:this._options.onShow,onShown:this._options.onShown,onHide:this._options.onHide,onHidden:this._options.onHidden,onNext:this._options.onNext,onPrev:this._options.onPrev,onPause:this._options.onPause,onResume:this._options.onResume,onRedirectError:this._options.onRedirectError},this._options.steps[t])},i.prototype.init=function(n){return(this._force=n,this.ended())?(this._debug("Tour ended, init prevented."),this):(this.setCurrentStep(),this._initMouseNavigation(),this._initKeyboardNavigation(),this._onResize(function(n){return function(){return n.showStep(n._current)}}(this)),this._current!==null&&this.showStep(this._current),this._inited=!0,this)},i.prototype.start=function(n){var t;return n==null&&(n=!1),this._inited||this.init(n),this._current===null&&(t=this._makePromise(this._options.onStart!=null?this._options.onStart(this):void 0),this._callOnPromiseDone(t,this.showStep,0)),this},i.prototype.next=function(){var n;return n=this.hideStep(this._current,this._current+1),this._callOnPromiseDone(n,this._showNextStep)},i.prototype.prev=function(){var n;return n=this.hideStep(this._current,this._current-1),this._callOnPromiseDone(n,this._showPrevStep)},i.prototype.goTo=function(n){var t;return t=this.hideStep(this._current,n),this._callOnPromiseDone(t,this.showStep,n)},i.prototype.end=function(){var i,r;return i=function(i){return function(){if(n(t).off("click.tour-"+i._options.name),n(t).off("keyup.tour-"+i._options.name),n(window).off("resize.tour-"+i._options.name),i._setState("end","yes"),i._inited=!1,i._force=!1,i._clearTimer(),i._options.onEnd!=null)return i._options.onEnd(i)}}(this),r=this.hideStep(this._current),this._callOnPromiseDone(r,i)},i.prototype.ended=function(){return!this._force&&!!this._getState("end")},i.prototype.restart=function(){return this._removeState("current_step"),this._removeState("end"),this._removeState("redirect_to"),this.start()},i.prototype.pause=function(){var n;if(n=this.getStep(this._current),!(n&&n.duration))return this;if(this._paused=!0,this._duration-=(new Date).getTime()-this._start,window.clearTimeout(this._timer),this._debug("Paused/Stopped step "+(this._current+1)+" timer ("+this._duration+" remaining)."),n.onPause!=null)return n.onPause(this,this._duration)},i.prototype.resume=function(){var n;if(n=this.getStep(this._current),!(n&&n.duration))return this;if(this._paused=!1,this._start=(new Date).getTime(),this._duration=this._duration||n.duration,this._timer=window.setTimeout(function(n){return function(){return n._isLast()?n.next():n.end()}}(this),this._duration),this._debug("Started step "+(this._current+1)+" timer with duration "+this._duration),n.onResume!=null&&this._duration!==n.duration)return n.onResume(this,this._duration)},i.prototype.hideStep=function(t,i){var u,e,f,r;if(r=this.getStep(t),r)return this._clearTimer(),f=this._makePromise(r.onHide!=null?r.onHide(this,t):void 0),e=function(u){return function(){var f,e;if(f=n(r.element),f.data("bs.popover")||f.data("popover")||(f=n("body")),f.popover("destroy").removeClass("tour-"+u._options.name+"-element tour-"+u._options.name+"-"+t+"-element").removeData("bs.popover").focus(),r.reflex&&n(r.reflexElement).removeClass("tour-step-element-reflex").off(""+u._reflexEvent(r.reflex)+".tour-"+u._options.name),r.backdrop&&(e=i!=null&&u.getStep(i),e&&e.backdrop&&e.backdropElement===r.backdropElement||u._hideBackdrop()),r.onHidden!=null)return r.onHidden(u)}}(this),u=r.delay.hide||r.delay,{}.toString.call(u)==="[object Number]"&&u>0?(this._debug("Wait "+u+" milliseconds to hide the step "+(this._current+1)),window.setTimeout(function(n){return function(){return n._callOnPromiseDone(f,e)}}(this),u)):this._callOnPromiseDone(f,e),f},i.prototype.showStep=function(n){var u,f,r,e,o,i;return this.ended()?(this._debug("Tour ended, showStep prevented."),this):(i=this.getStep(n),!i)?void 0:(o=n<this._current,f=this._makePromise(i.onShow!=null?i.onShow(this,n):void 0),this.setCurrentStep(n),u=function(){switch({}.toString.call(i.path)){case"[object Function]":return i.path();case"[object String]":return this._options.basePath+i.path;default:return i.path}}.call(this),i.redirect&&this._isRedirect(i.host,u,t.location)&&(this._redirect(i,n,u),!this._isJustPathHashDifferent(i.host,u,t.location)))?void 0:(e=function(t){return function(){var r;if(t._isOrphan(i)){if(i.orphan===!1){t._debug("Skip the orphan step "+(t._current+1)+".\nOrphan option is false and the element does not exist or is hidden.");o?t._showPrevStep():t._showNextStep();return}t._debug("Show the orphan step "+(t._current+1)+". Orphans option is true.")}return i.backdrop&&t._showBackdrop(i),r=function(){if(t.getCurrentStep()===n&&!t.ended()){if(i.element!=null&&i.backdrop&&t._showOverlayElement(i,!0),t._showPopover(i,n),i.onShown!=null)i.onShown(t);return t._debug("Step "+(t._current+1)+" of "+t._options.steps.length)}},i.autoscroll?t._scrollIntoView(i,r):r(),i.duration?t.resume():void 0}}(this),r=i.delay.show||i.delay,{}.toString.call(r)==="[object Number]"&&r>0?(this._debug("Wait "+r+" milliseconds to show the step "+(this._current+1)),window.setTimeout(function(n){return function(){return n._callOnPromiseDone(f,e)}}(this),r)):this._callOnPromiseDone(f,e),f)},i.prototype.getCurrentStep=function(){return this._current},i.prototype.setCurrentStep=function(n){return n!=null?(this._current=n,this._setState("current_step",n)):(this._current=this._getState("current_step"),this._current=this._current===null?null:parseInt(this._current,10)),this},i.prototype.redraw=function(){return this._showOverlayElement(this.getStep(this.getCurrentStep()).element,!0)},i.prototype._setState=function(n,t){var r,i;if(this._options.storage){i=""+this._options.name+"_"+n;try{this._options.storage.setItem(i,t)}catch(u){r=u;r.code===DOMException.QUOTA_EXCEEDED_ERR&&this._debug("LocalStorage quota exceeded. State storage failed.")}return this._options.afterSetState(i,t)}return this._state==null&&(this._state={}),this._state[n]=t},i.prototype._removeState=function(n){var t;return this._options.storage?(t=""+this._options.name+"_"+n,this._options.storage.removeItem(t),this._options.afterRemoveState(t)):this._state!=null?delete this._state[n]:void 0},i.prototype._getState=function(n){var i,t;return this._options.storage?(i=""+this._options.name+"_"+n,t=this._options.storage.getItem(i)):this._state!=null&&(t=this._state[n]),(t===void 0||t==="null")&&(t=null),this._options.afterGetState(n,t),t},i.prototype._showNextStep=function(){var t,i,n;return n=this.getStep(this._current),i=function(t){return function(){return t.showStep(n.next)}}(this),t=this._makePromise(n.onNext!=null?n.onNext(this):void 0),this._callOnPromiseDone(t,i)},i.prototype._showPrevStep=function(){var t,i,n;return n=this.getStep(this._current),i=function(t){return function(){return t.showStep(n.prev)}}(this),t=this._makePromise(n.onPrev!=null?n.onPrev(this):void 0),this._callOnPromiseDone(t,i)},i.prototype._debug=function(n){if(this._options.debug)return window.console.log("Bootstrap Tour '"+this._options.name+"' | "+n)},i.prototype._isRedirect=function(n,t,i){var r;return n!=null&&n!==""&&({}.toString.call(n)==="[object RegExp]"&&!n.test(i.origin)||{}.toString.call(n)==="[object String]"&&this._isHostDifferent(n,i))?!0:(r=[i.pathname,i.search,i.hash].join(""),t!=null&&t!==""&&({}.toString.call(t)==="[object RegExp]"&&!t.test(r)||{}.toString.call(t)==="[object String]"&&this._isPathDifferent(t,r)))},i.prototype._isHostDifferent=function(n,t){switch({}.toString.call(n)){case"[object RegExp]":return!n.test(t.origin);case"[object String]":return this._getProtocol(n)!==this._getProtocol(t.href)||this._getHost(n)!==this._getHost(t.href);default:return!0}},i.prototype._isPathDifferent=function(n,t){return this._getPath(n)!==this._getPath(t)||!this._equal(this._getQuery(n),this._getQuery(t))||!this._equal(this._getHash(n),this._getHash(t))},i.prototype._isJustPathHashDifferent=function(n,t,i){var r;return n!=null&&n!==""&&this._isHostDifferent(n,i)?!1:(r=[i.pathname,i.search,i.hash].join(""),{}.toString.call(t)==="[object String]")?this._getPath(t)===this._getPath(r)&&this._equal(this._getQuery(t),this._getQuery(r))&&!this._equal(this._getHash(t),this._getHash(r)):!1},i.prototype._redirect=function(i,r,u){var f;if(n.isFunction(i.redirect))return i.redirect.call(this,u);if(f={}.toString.call(i.host)==="[object String]"?""+i.host+u:u,this._debug("Redirect to "+f),this._getState("redirect_to")===""+r){if(this._debug("Error redirection loop to "+u),this._removeState("redirect_to"),i.onRedirectError!=null)return i.onRedirectError(this)}else return this._setState("redirect_to",""+r),t.location.href=f},i.prototype._isOrphan=function(t){return t.element==null||!n(t.element).length||n(t.element).is(":hidden")&&n(t.element)[0].namespaceURI!=="http://www.w3.org/2000/svg"},i.prototype._isLast=function(){return this._current<this._options.steps.length-1},i.prototype._showPopover=function(t,i){var r,u,f,e,o;if(n(".tour-"+this._options.name).remove(),e=n.extend({},this._options),f=this._isOrphan(t),t.template=this._template(t,i),f&&(t.element="body",t.placement="top"),r=n(t.element),r.addClass("tour-"+this._options.name+"-element tour-"+this._options.name+"-"+i+"-element"),t.options&&n.extend(e,t.options),t.reflex&&!f)n(t.reflexElement).addClass("tour-step-element-reflex").off(""+this._reflexEvent(t.reflex)+".tour-"+this._options.name).on(""+this._reflexEvent(t.reflex)+".tour-"+this._options.name,function(n){return function(){return n._isLast()?n.next():n.end()}}(this));return o=t.smartPlacement===!0&&t.placement.search(/auto/i)===-1,r.popover({placement:o?"auto "+t.placement:t.placement,trigger:"manual",title:t.title,content:t.content,html:!0,animation:t.animation,container:t.container,template:t.template,selector:t.element}).popover("show"),u=r.data("bs.popover")?r.data("bs.popover").tip():r.data("popover").tip(),u.attr("id",t.id),this._focus(u,r,t.next<0),this._reposition(u,t),f?this._center(u):void 0},i.prototype._template=function(t,i){var f,e,o,s,r,u;return u=t.template,this._isOrphan(t)&&{}.toString.call(t.orphan)!=="[object Boolean]"&&(u=t.orphan),r=n.isFunction(u)?n(u(i,t)):n(u),f=r.find(".popover-navigation"),o=f.find('[data-role="prev"]'),e=f.find('[data-role="next"]'),s=f.find('[data-role="pause-resume"]'),this._isOrphan(t)&&r.addClass("orphan"),r.addClass("tour-"+this._options.name+" tour-"+this._options.name+"-"+i),t.reflex&&r.addClass("tour-"+this._options.name+"-reflex"),t.prev<0&&o.addClass("disabled").prop("disabled",!0).prop("tabindex",-1),t.next<0&&e.addClass("disabled").prop("disabled",!0).prop("tabindex",-1),t.duration||s.remove(),r.clone().wrap("<div>").parent().html()},i.prototype._reflexEvent=function(n){return{}.toString.call(n)==="[object Boolean]"?"click":n},i.prototype._focus=function(n,t,i){var r,u;u=i?"end":"next";r=n.find("[data-role='"+u+"']");return t.on("shown.bs.popover",function(){return r.focus()})},i.prototype._reposition=function(i,r){var f,h,e,c,o,s,u;if(c=i[0].offsetWidth,h=i[0].offsetHeight,u=i.offset(),o=u.left,s=u.top,f=n(t).outerHeight()-u.top-i.outerHeight(),f<0&&(u.top=u.top+f),e=n("html").outerWidth()-u.left-i.outerWidth(),e<0&&(u.left=u.left+e),u.top<0&&(u.top=0),u.left<0&&(u.left=0),i.offset(u),r.placement==="bottom"||r.placement==="top"){if(o!==u.left)return this._replaceArrow(i,(u.left-o)*2,c,"left")}else if(s!==u.top)return this._replaceArrow(i,(u.top-s)*2,h,"top")},i.prototype._center=function(t){return t.css("top",n(window).outerHeight()/2-t.outerHeight()/2)},i.prototype._replaceArrow=function(n,t,i,r){return n.find(".arrow").css(r,t?50*(1-t/i)+"%":"")},i.prototype._scrollIntoView=function(t,i){var u,o,h,s,f,r,e;if(u=n(t.element),!u.length)return i();o=n(window);f=u.offset().top;s=u.outerHeight();e=o.height();r=0;switch(t.placement){case"top":r=Math.max(0,f-e/2);break;case"left":case"right":r=Math.max(0,f+s/2-e/2);break;case"bottom":r=Math.max(0,f+s-e/2)}return this._debug("Scroll into view. ScrollTop: "+r+". Element offset: "+f+". Window height: "+e+"."),h=0,n("body, html").stop(!0,!0).animate({scrollTop:Math.ceil(r)},function(n){return function(){if(++h==2)return i(),n._debug("Scroll into view.\nAnimation end element offset: "+u.offset().top+".\nWindow height: "+o.height()+".")}}(this))},i.prototype._onResize=function(t,i){return n(window).on("resize.tour-"+this._options.name,function(){return clearTimeout(i),i=setTimeout(t,100)})},i.prototype._initMouseNavigation=function(){var i=this;return n(t).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']",function(n){return function(t){return t.preventDefault(),n.next()}}(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']",function(n){return function(t){return t.preventDefault(),n._current>0?n.prev():void 0}}(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']",function(n){return function(t){return t.preventDefault(),n.end()}}(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']",function(t){var r;return t.preventDefault(),r=n(this),r.text(i._paused?r.data("pause-text"):r.data("resume-text")),i._paused?i.resume():i.pause()})},i.prototype._initKeyboardNavigation=function(){if(this._options.keyboard)return n(t).on("keyup.tour-"+this._options.name,function(n){return function(t){if(t.which)switch(t.which){case 39:return t.preventDefault(),n._isLast()?n.next():n.end();case 37:if(t.preventDefault(),n._current>0)return n.prev()}}}(this))},i.prototype._makePromise=function(t){return t&&n.isFunction(t.then)?t:null},i.prototype._callOnPromiseDone=function(n,t,i){return n?n.then(function(n){return function(){return t.call(n,i)}}(this)):t.call(this,i)},i.prototype._showBackdrop=function(t){if(!this.backdrop.backgroundShown)return this.backdrop=n("<div>",{"class":"tour-backdrop"}),this.backdrop.backgroundShown=!0,n(t.backdropContainer).append(this.backdrop)},i.prototype._hideBackdrop=function(){return this._hideOverlayElement(),this._hideBackground()},i.prototype._hideBackground=function(){if(this.backdrop&&this.backdrop.remove)return this.backdrop.remove(),this.backdrop.overlay=null,this.backdrop.backgroundShown=!1},i.prototype._showOverlayElement=function(t,i){var u,f,r;if(f=n(t.element),u=n(t.backdropElement),f&&f.length!==0&&(!this.backdrop.overlayElementShown||i))return this.backdrop.overlayElementShown||(this.backdrop.$element=u.addClass("tour-step-backdrop"),this.backdrop.$background=n("<div>",{"class":"tour-step-background"}),this.backdrop.$background.appendTo(t.backdropContainer),this.backdrop.overlayElementShown=!0),r={width:u.innerWidth(),height:u.innerHeight(),offset:u.offset()},t.backdropPadding&&(r=this._applyBackdropPadding(t.backdropPadding,r)),this.backdrop.$background.width(r.width).height(r.height).offset(r.offset)},i.prototype._hideOverlayElement=function(){if(this.backdrop.overlayElementShown)return this.backdrop.$element.removeClass("tour-step-backdrop"),this.backdrop.$background.remove(),this.backdrop.$element=null,this.backdrop.$background=null,this.backdrop.overlayElementShown=!1},i.prototype._applyBackdropPadding=function(n,t){return typeof n=="object"?(n.top==null&&(n.top=0),n.right==null&&(n.right=0),n.bottom==null&&(n.bottom=0),n.left==null&&(n.left=0),t.offset.top=t.offset.top-n.top,t.offset.left=t.offset.left-n.left,t.width=t.width+n.left+n.right,t.height=t.height+n.top+n.bottom):(t.offset.top=t.offset.top-n,t.offset.left=t.offset.left-n,t.width=t.width+n*2,t.height=t.height+n*2),t},i.prototype._clearTimer=function(){return window.clearTimeout(this._timer),this._timer=null,this._duration=null},i.prototype._getProtocol=function(n){return n=n.split("://"),n.length>1?n[0]:"http"},i.prototype._getHost=function(n){return n=n.split("//"),n=n.length>1?n[1]:n[0],n.split("/")[0]},i.prototype._getPath=function(n){return n.replace(/\/?$/,"").split("?")[0].split("#")[0]},i.prototype._getQuery=function(n){return this._getParams(n,"?")},i.prototype._getHash=function(n){return this._getParams(n,"#")},i.prototype._getParams=function(n,t){var r,i,f,u,e;if(i=n.split(t),i.length===1)return{};for(i=i[1].split("&"),f={},u=0,e=i.length;u<e;u++)r=i[u],r=r.split("="),f[r[0]]=r[1]||"";return f},i.prototype._equal=function(n,t){var i,f,e,r,u,o;if({}.toString.call(n)==="[object Object]"&&{}.toString.call(t)==="[object Object]"){if(f=Object.keys(n),e=Object.keys(t),f.length!==e.length)return!1;for(i in n)if(r=n[i],!this._equal(t[i],r))return!1;return!0}if({}.toString.call(n)==="[object Array]"&&{}.toString.call(t)==="[object Array]"){if(n.length!==t.length)return!1;for(i=u=0,o=n.length;u<o;i=++u)if(r=n[i],!this._equal(r,t[i]))return!1;return!0}return n===t},i}()});